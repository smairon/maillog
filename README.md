# Тестовое задание

Приложение для работы с логами. Функции:

- Разбор файла с логом
- Загрузка разобранных структур в БД
- Поиск по базе логов

## Требования к среде выполнения

- Unix подобная ОС
- Установленный docker
- Установленный docker-compose

## Разворачивание

Состав сервисов:

- БД Postgres 16
- Сервис api

Клонируем репозиторий

```bash
git clone git@github.com:smairon/maillog.git
```

Переходим в папку проекта и деплоим стек

 ```bash
 cd maillog
 make deploy
 ```

После окончания процесса разворачивания запускаем миграции

```bash
make db_upgrade
```

## Работа с приложением

Документацию по api в формате OpenAPI можно найти по [адресу](http://localhost:30060/docs)

Фронт приложения - index.html просто открыть его в браузере

Запуск разбора лога

```bash
make parse
```

Сам лог нужно положить в папку `./data`  под именем `mail.log`

Очистить БД:

```bash
make db_downgrade
make db_upgrade
```

## Комментарии

Так как на выполнение задания я не мог выделить более 3-х часов, то многие углы срезаны.
Часть из них указана в виде комментариев в коде, часть написана ниже.

В реальном мире данная система могла бы быть прототипом,
основной для менее абстрактного и более предметного разговора с заказчиком.

В реальной работе, в зависимости от ситуации, имеет смысл все непонятные моменты обговорить заранее.
Если, конечно же, заказчик сам понимает чего хочет. Если нет, то двигаемся итеративно, начиная с такого MVP,
постепенно уточняя требования.

### Возможные улучшения

- В случае большого файла с логами сделать возможность разбиения его на части с параллельной обработкой
- Добавить фоновый воркер для мониторинга появления новых логов и автоматического разбора их
- Сделать более дружелюбный в контексте UI фронтенд в виде отдельного приложения
- Пересмотреть схему хранения данных, возможно имеет смысл предпочесть индексирующие движки типа Elastic реляционной
  модели
- Можно так же рассмотреть полное разделение функций разбора/импорта логов и поиска по ним на разные системные сервисы
- Добавить тесты на логику разбора логов